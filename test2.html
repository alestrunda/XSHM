<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>XSHM</title>
  </head>

  <body class="container">
    <ul class="nav">
      <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="/login/">Login page</a></li>
      <li class="nav-item"><a class="nav-link" href="/secret/">Secret page</a></li>
      <li class="nav-item"><a class="nav-link" href="/test1.html">Test 1</a></li>
      <li class="nav-item"><a class="nav-link" href="/test2.html">Test 2</a></li>
    </ul>
  
    <div class="alert alert-primary" role="alert">
      Status: <strong><span id="status"></span></strong>
    </div>

    <hr />

    <iframe id="iframe" width="250" height="180" src="/secret/"></iframe>
    <script>
      var delay = 500; //ms, let's simulate a bit of a delay, so we do not need to bother to check whether the iframe content has been loaded
      var origHistoryLength = history.length;
      console.log("current history length: " + origHistoryLength);

      setTimeout(function () {
        document.getElementById("iframe").src = "/login/";
        setTimeout(function () {
          console.log("new history length: " + history.length);
          var isHistorySame = history.length === origHistoryLength;
          document.getElementById("status").innerHTML = isHistorySame
            ? "NOT logged in"
            : "logged in";
          document.getElementById("status").style.color = isHistorySame
            ? "red"
            : "green";
        }, delay);
      }, delay);
    </script>
  </body>
</html>
